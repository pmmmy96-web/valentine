<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ’˜</title>

<style>
body{
  margin:0;
  height:100dvh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family:system-ui;
  background:linear-gradient(135deg,#ffd6e0,#fff5d9);
  overflow:hidden;
}

canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1;
}

.card{
  width:min(420px,92vw);
  background:#fff;
  padding:25px;
  border-radius:24px;
  box-shadow:0 15px 40px rgba(0,0,0,.15);
  text-align:center;
  z-index:2;
  position:relative;
}

h2{ margin-bottom:15px; }

.stage{
  position:relative;
  height:200px;
}

button{
  padding:14px 20px;
  font-size:18px;
  font-weight:800;
  border:none;
  border-radius:14px;
  cursor:pointer;
}

.yes{
  background:#ff4d6d;
  color:white;
}

.no{
  position:absolute;
  background:#e9ecef;
  left:60%;
  top:60%;
  transition:.07s;
}

.photoWrap{
  display:none;
  margin-top:15px;
}

.photoWrap.show{
  display:block;
}

.photo{
  width:100%;
  border-radius:18px;
}
</style>
</head>

<body>

<canvas id="fx"></canvas>

<div class="card">
  <h2 id="question">ç„¡å°¾ç†Šæœƒä¸€ç›´æ„›è‘—æ€ªç¸å°å§ï¼Ÿ ğŸ’</h2>

  <div class="stage">
    <button class="yes" id="yesBtn">YES</button>
    <button class="no" id="noBtn">NO</button>
  </div>

  <div class="photoWrap" id="photoWrap">
    <img src="photo.jpg" class="photo">
  </div>
</div>

<script>
const question = document.getElementById("question");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const photoWrap = document.getElementById("photoWrap");
let step = 1;

/* NO ë„ë§ */
function moveNo(){
  const stage = document.querySelector(".stage");
  const rect = stage.getBoundingClientRect();
  const btnRect = noBtn.getBoundingClientRect();

  const x = Math.random() * (rect.width - btnRect.width);
  const y = Math.random() * (rect.height - btnRect.height);

  noBtn.style.left = x + "px";
  noBtn.style.top  = y + "px";
}

function runAway(e){
  const b = noBtn.getBoundingClientRect();
  const x = e.touches ? e.touches[0].clientX : e.clientX;
  const y = e.touches ? e.touches[0].clientY : e.clientY;

  const d = Math.hypot(x - (b.left+b.width/2), y - (b.top+b.height/2));
  if(d < 90) moveNo();
}

document.addEventListener("pointermove", runAway);
document.addEventListener("touchmove", runAway);

noBtn.addEventListener("click",(e)=>{
  e.preventDefault();
  moveNo();
});

window.onload = moveNo;

/* YES í´ë¦­ */
yesBtn.addEventListener("click",()=>{
  if(step === 1){
    question.innerText = "è¦ä¸è¦è·Ÿæˆ‘è¦ªå¯†ä¸€ä¸‹ï¼Ÿ ğŸ˜ˆ";
    step = 2;
    moveNo();
  }else{
    photoWrap.classList.add("show");
    burst();
  }
});

/* í•˜íŠ¸í­ì£½ */
const canvas = document.getElementById("fx");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const particles=[];

function burst(){
  for(let i=0;i<80;i++){
    particles.push({
      x:innerWidth/2,
      y:innerHeight/2,
      vx:(Math.random()-0.5)*6,
      vy:(Math.random()-0.5)*6,
      life:80
    });
  }
  animate();
}

function drawHeart(x,y){
  ctx.beginPath();
  ctx.moveTo(x,y);
  ctx.bezierCurveTo(x+5,y-5,x+15,y+5,x,y+15);
  ctx.bezierCurveTo(x-15,y+5,x-5,y-5,x,y);
  ctx.fillStyle="red";
  ctx.fill();
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1;i>=0;i--){
    let p=particles[i];
    p.x+=p.vx;
    p.y+=p.vy;
    p.life--;
    drawHeart(p.x,p.y);
    if(p.life<=0) particles.splice(i,1);
  }
  if(particles.length>0) requestAnimationFrame(animate);
}
</script>

</body>
</html>
